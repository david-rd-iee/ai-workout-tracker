import{Cb as D,Fb as m,Gb as u,Hb as g,Kb as n,Lb as c,Nb as t,b as f,d as l,zb as S}from"./chunk-GYEOV455.js";import{g as h}from"./chunk-PM2M367S.js";var P=(()=>{let s=class s{constructor(e,r){this.auth=e,this.firestore=r,this.devEmail="dev-tester@example.com",this.devPassword="devtester123",this.DEV_UID="Zas8MzSObSfvv3SRMINzWMiQFg63",this.devGroupScenario="none",this.ptGroupId="DEV_PT_GROUP",this.friendsGroupId="DEV_FRIENDS_GROUP"}ensureDevUserAndSeed(){return h(this,null,function*(){console.log("[DevSeedService] ensureDevUserAndSeed() starting...");let e=null;try{e=(yield m(this.auth,this.devEmail,this.devPassword)).user,console.log("[DevSeedService] Signed in existing dev user:",e.uid)}catch(o){if(o?.code==="auth/user-not-found")console.log("[DevSeedService] Dev user not found, creating new one..."),e=(yield D(this.auth,this.devEmail,this.devPassword)).user,console.log("[DevSeedService] Created dev user:",e.uid);else throw console.error("[DevSeedService] Error signing in dev user:",o),o}if(!e)throw new Error("[DevSeedService] Dev user is null after sign-in/sign-up");let r=this.DEV_UID;if(e.uid!==r)throw new Error(`[DevSeedService] Auth UID mismatch.
Signed-in Auth uid=${e.uid}
But DEV_UID=${r}
Fix: sign into the Firebase Auth user whose UID is ${r} (update devEmail/devPassword), or remove this guard if you intentionally want mismatch.`);console.log("[DevSeedService] Using dev UID (Firestore doc id):",r);let a=n(this.firestore,"users",r);(yield c(a)).exists()?(console.log("[DevSeedService] /users doc already exists for dev user."),yield t(a,{groupID:[]},{merge:!0})):(console.log("[DevSeedService] Creating /users doc for dev user..."),yield t(a,{email:this.devEmail,firstName:"Dev",lastName:"Tester",username:"devtester",role:"client",profilePic:"",groupID:[],created_at:u()}));let d=n(this.firestore,"userStats",r);(yield c(d)).exists()||(console.log("[DevSeedService] Creating /userStats doc for dev user..."),yield t(d,{displayName:"Dev Tester",total_work_score:1500,cardio_work_score:900,strength_work_score:600,level:7,last_updated_at:u()}))})}ensureDevGroupsAndMembership(e){return h(this,null,function*(){console.log("[DevSeedService] ensureDevGroupsAndMembership() scenario:",this.devGroupScenario);let r="groupID",a=n(this.firestore,"users",e),v=n(this.firestore,r,this.ptGroupId),d=n(this.firestore,r,this.friendsGroupId);(this.devGroupScenario==="pt"||this.devGroupScenario==="both")&&((yield c(v)).exists()||(yield t(v,{groupId:this.ptGroupId,name:"Dev PT Group",isPTGroup:!0,ownerUserId:e,created_at:u()}))),(this.devGroupScenario==="friends"||this.devGroupScenario==="both")&&((yield c(d)).exists()||(yield t(d,{groupId:this.friendsGroupId,name:"Dev Friends Group",isPTGroup:!1,ownerUserId:e,created_at:u()})));let i=[];this.devGroupScenario==="pt"?i.push(this.ptGroupId):this.devGroupScenario==="friends"?i.push(this.friendsGroupId):this.devGroupScenario==="both"&&i.push(this.ptGroupId,this.friendsGroupId),console.log("[DevSeedService] Setting groupID on /users doc:",i),yield t(a,{groupID:i},{merge:!0})})}};s.\u0275fac=function(r){return new(r||s)(l(S),l(g))},s.\u0275prov=f({token:s,factory:s.\u0275fac,providedIn:"root"});let p=s;return p})();export{P as a};
