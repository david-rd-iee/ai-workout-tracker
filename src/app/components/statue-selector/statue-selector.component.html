<ion-header>
  <ion-toolbar>
    <ion-title>Choose Display Statues</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="cancel()">
        <ion-icon name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="selector-header">
    <p>Select up to {{ maxDisplayStatues }} carved statues to showcase in your divine gallery (or select none to hide statues)</p>
    <div class="selection-actions">
      <p class="selection-count">
        Selected: {{ selectedStatueIds.length }} / {{ maxDisplayStatues }}
      </p>
      <ion-button 
        *ngIf="selectedStatueIds.length > 0"
        fill="clear" 
        size="small" 
        (click)="clearSelection()"
        color="medium"
      >
        Clear All
      </ion-button>
    </div>
  </div>

  <div class="filters-section">
    <div class="filter-group">
      <label class="filter-label">Filter by Category</label>
      <ion-segment [value]="selectedCategory" (ionChange)="selectedCategory = $any($event).detail.value" class="category-filter" scrollable="true">
        <ion-segment-button *ngFor="let cat of categories" [value]="cat">
          <ion-label class="category-label">{{ cat | titlecase }}</ion-label>
        </ion-segment-button>
      </ion-segment>
    </div>
    
    <div class="filter-group">
      <label class="filter-label">Sort by</label>
      <ion-segment [value]="sortBy" (ionChange)="sortBy = $any($event).detail.value" class="sort-filter">
        <ion-segment-button value="carving">
          <ion-label>Progress (Rarity)</ion-label>
        </ion-segment-button>
        <ion-segment-button value="category">
          <ion-label>Type</ion-label>
        </ion-segment-button>
      </ion-segment>
    </div>
  </div>

  <div class="statues-list">
    <div 
      *ngFor="let statue of filteredStatues"
      class="statue-wrapper"
      [class.selected]="isStatueSelected(statue.id)"
      [class.disabled]="!isStatueSelected(statue.id) && !canSelectMore()"
      (click)="toggleStatue(statue.id)"
    >
      <app-greek-statue 
        [statue]="statue" 
        [showProgress]="false"
        size="small"
      ></app-greek-statue>
      
      <div class="selection-indicator" *ngIf="isStatueSelected(statue.id)">
        <ion-icon name="checkmark-circle" color="primary"></ion-icon>
      </div>
    </div>
  </div>

  <div class="empty-state" *ngIf="filteredStatues.length === 0">
    <p>No statues carved yet in this category. Keep training to begin your divine sculptures!</p>
  </div>

  <div class="button-container">
    <ion-button 
      expand="block" 
      (click)="confirm()" 
      color="primary"
    >
      {{ selectedStatueIds.length === 0 ? 'Hide All Statues' : 'Save Selection' }}
    </ion-button>
    <ion-button expand="block" (click)="cancel()" fill="outline" color="medium">
      Cancel
    </ion-button>
  </div>
</ion-content>
