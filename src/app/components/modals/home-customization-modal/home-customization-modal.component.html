<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Customize Home Page</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="dismiss()">
        <ion-icon name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="modal-content">
    <!-- Client Header -->
    <div class="client-header">
      <div class="client-avatar">
        <ion-icon name="person-circle"></ion-icon>
      </div>
      <div class="client-info">
        <h2>{{ clientName }}</h2>
        <p>Personalize their home page experience</p>
      </div>
    </div>

    <!-- Widgets Section -->
    <ion-card class="widgets-card">
      <ion-card-header>
        <div class="card-header-with-icon">
          <ion-icon name="grid-outline" color="primary"></ion-icon>
          <ion-card-title>Home Page Widgets</ion-card-title>
        </div>
        <p class="subtitle">Select which widgets to display on the home page</p>
      </ion-card-header>
      <ion-card-content>
        <div class="widgets-grid">
          <div 
            *ngFor="let widget of widgets" 
            class="widget-toggle-card"
            [class.enabled]="widget.enabled"
            (click)="widget.enabled = !widget.enabled"
          >
            <div class="widget-icon">
              <ion-icon [name]="widget.icon"></ion-icon>
            </div>
            <div class="widget-info">
              <h3>{{ widget.name }}</h3>
              <p>{{ widget.description }}</p>
            </div>
            <div class="widget-toggle">
              <ion-toggle 
                [(ngModel)]="widget.enabled"
                (click)="$event.stopPropagation()"
              ></ion-toggle>
            </div>
          </div>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Preview Section -->
    <ion-card class="preview-card">
      <ion-card-header>
        <div class="card-header-with-icon">
          <ion-icon name="eye-outline" color="success"></ion-icon>
          <ion-card-title>Preview</ion-card-title>
        </div>
        <p class="subtitle">How the home page will look</p>
      </ion-card-header>
      <ion-card-content>
        <div class="preview-list">
          <div 
            *ngFor="let widget of getEnabledWidgets(); let i = index" 
            class="preview-item"
          >
            <span class="preview-number">{{ i + 1 }}</span>
            <ion-icon [name]="widget.icon" color="primary"></ion-icon>
            <span class="preview-name">{{ widget.name }}</span>
          </div>
          <div *ngIf="getEnabledWidgets().length === 0" class="empty-state">
            <ion-icon name="alert-circle-outline"></ion-icon>
            <p>No widgets enabled. Enable at least one widget above.</p>
          </div>
        </div>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>

<div class="modal-footer">
  <ion-button expand="block" (click)="saveConfiguration()" color="primary" size="large" class="save-btn">
    <ion-icon name="checkmark-circle" slot="start"></ion-icon>
    Save Configuration
  </ion-button>
</div>
