<!-- <app-header [transparent]="true"></app-header> -->

<ion-content [fullscreen]="true">
  <div class="background-gradient"></div>
  
  <div class="client-info" *ngIf="!isLoading()">
    <ion-card class="profile-header-card">
      <ion-card-content>
        <div class="profile-header">
          <div class="image-container">
            <app-image-uploader [currentImageUrl]="clientInfo.profileImage" (imageSelected)="onImageSelected($event)">
            </app-image-uploader>
          </div>
          <h1>{{clientInfo.firstName | titlecase}} {{clientInfo.lastName | titlecase}}</h1>
        </div>
      </ion-card-content>
    </ion-card>
     
    <!-- Greek Statues Section -->
    <ion-card>
      <ion-list lines="full">
        <ion-item>
          <ion-icon slot="start" name="fitness" color="primary"></ion-icon>
          <ion-label>
            <h2>Statues of Progress</h2>
          </ion-label>
          <ion-button 
            *ngIf="isOwnProfile" 
            slot="end"
            fill="clear" 
            (click)="openBadgeSelector()"
            size="small"
          >
            <ion-icon slot="icon-only" name="create-outline"></ion-icon>
          </ion-button>
        </ion-item>
      </ion-list>
      <ion-card-content>
        <div class="display-statues-carousel" *ngIf="displayStatues.length > 0; else noBadges">
          <swiper-container
            [slidesPerView]="1"
            [centeredSlides]="true"
            [spaceBetween]="20"
            [pagination]="false"
            class="statue-swiper"
            (swiperslidechange)="onSlideChange($event)"
          >
            <swiper-slide *ngFor="let statue of displayStatues">
              <div class="podium-container">
                <div class="statue-showcase">
                  <app-greek-statue 
                    [statue]="statue" 
                    [showProgress]="true"
                    size="large"
                  ></app-greek-statue>
                </div>
                <div class="podium">
                  <div class="podium-top"></div>
                  <div class="podium-body">
                    <div class="podium-inscription">{{ statue.godName }}</div>
                  </div>
                </div>
              </div>
            </swiper-slide>
          </swiper-container>
          <div class="custom-pagination">
            <span 
              class="pagination-dot" 
              *ngFor="let statue of displayStatues; let i = index"
              [class.active]="i === currentSlideIndex"
            ></span>
          </div>
        </div>
        <ng-template #noBadges>
          <p class="no-badges-text" *ngIf="carvedStatuesCount === 0">
            Complete workouts to begin carving your statues! 
            <br><small>Track your progress and showcase your divine masterpieces.</small>
          </p>
          <p class="no-badges-text" *ngIf="carvedStatuesCount > 0">
            No statues selected for display.
            <br><small>Click the button above to choose which statues to showcase.</small>
          </p>
        </ng-template>
      </ion-card-content>
    </ion-card>

    <div class="section-divider" *ngIf="allStatues.length > 0 && isOwnProfile"></div>

    <!-- All Achievements Section (Only visible to profile owner) -->
    <ion-card *ngIf="allStatues.length > 0 && isOwnProfile">
      <ion-list lines="full">
        <ion-item>
          <ion-icon slot="start" name="medal" color="primary"></ion-icon>
          <ion-label>
            <h2>All Statues</h2>
            <p class="achievement-subtitle">{{ carvedStatuesCount }}/{{ allStatues.length }} carved â€¢ Only you can see this</p>
          </ion-label>
        </ion-item>
      </ion-list>
      <ion-card-content>
        <div class="achievements-container" [class.collapsed]="!showAllAchievements">
          <div class="all-badges-list">
            <ng-container *ngFor="let statue of visibleAchievements; let i = index; let last = last">
              <div class="achievement-item" [class.faded]="!showAllAchievements && i === initialAchievementsCount">
                <app-greek-statue 
                  [statue]="statue" 
                  [showProgress]="true"
                  size="small"
                ></app-greek-statue>
              </div>
              <div class="achievement-divider" *ngIf="!last"></div>
            </ng-container>
          </div>
          
          <ion-button 
            *ngIf="allStatues.length > initialAchievementsCount"
            expand="block" 
            fill="solid" 
            (click)="toggleShowAllAchievements()"
            class="show-more-button"
          >
            <ion-icon slot="start" [name]="showAllAchievements ? 'chevron-up' : 'chevron-down'"></ion-icon>
            {{ showAllAchievements ? 'Show Less' : 'Show More (' + (allStatues.length - initialAchievementsCount) + ' more)' }}
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>

    <div class="section-divider" *ngIf="isOwnProfile"></div>

    <ion-card *ngIf="isOwnProfile">
      <ion-list lines="full">
        <ion-item>
          <ion-icon slot="start" name="settings-outline"></ion-icon>
          <ion-label>
            <h3>Account Settings</h3>
            <p>Coming soon in dev mode</p>
          </ion-label>
        </ion-item>
      </ion-list>
    </ion-card>


    <ion-button *ngIf="isOwnProfile" expand="block" (click)="saveChanges()" class="save-button">
      Save Profile Photo
    </ion-button>
    

  </div>
  
</ion-content>
